SIEM project by Ruth Galchuk
============================
Software product that provides a real-time analysis of security alerts generated by applications and network hardware

Files
-----
- Sniffer.py -
- Log_Parser.py - it writes data from the log file to the DB
- Log_Analizer.py - gets data from the DB and analyze sort of attacks: ping sweep, port scan and suspicious ports
- Client.py -
- log_file.txt - log file for Log_Analizer's functions
 going to simulate Firewall’s log files and have a similar structure as the firewall
- sniff_log_file.txt - log file which records the sniffer

Instructions
------------
Use 'python SIEM\Client.py --help' for more information

Database
    All data is stored in the DB, for this purpose MySQL DB is used on a Linux server 16.04.

Log files structure:
    Delimiter - space
    •	Datetime – type of datetime, date and time (YYYY-m-d 00:00:00)
    •	Source IP – IP address of source (X.X.X.X)
    •	Destination IP – destination IP address (Y.Y.Y.Y)
    •	Port – destination port (445,23,80)
    •	Action – if packet dropped or not (Pass or Drop)
    For example:
    2018-4-21 19:42:41 192.168.1.1 192.168.2.100 445 PASS


Firewall log file Parser functions:
    1.	get dictionary from log file. Dictionary’s keys example:
    {'SRC_IP': '192.168.1.1', 'ACTION': 'PASS', 'DATE': '2018-4-21 19:42:48', 'DST_IP': '192.168.2.100', 'PORT': '445'}

    2.	get a port number and return protocol’s name. If port’s number doesn’t have a known protocol, write UNKOWN
    For example – PortToProtocol(23) -> TELNET
    For example – PortToProtocol(80) -> HTTP
    For example – PortToProtocol(4445) -> UNKNOWN

    Ports dictionary:
    PORTS = {'21' : 'FTP', '22' : 'SSH', '23' : 'TELNET', '25' : 'SMTP' , '67' : 'DHCP' , '53'  : 'DNS' , '80' : 'HTTP', '445' : 'SMB' ,'443' : 'HTTPS'}

    3.	Add a line to create a merge of log dictionary and protocol to get this dictionary:
    # {'PROTOCOL': 'SMB', 'SRC_IP': '192.168.1.1', 'ACTION': 'PASS', 'DATE': '2018-4-21 19:42:43', 'DST_IP': '192.168.2.100', 'PORT': '445'}

    4.	get a log dictionary and insert it into the DB.

Log Analyzer
    This python script gets data from the DB and analyze sort of attacks. We are going to define 4 different attacks:
    1.	Specific Port – IP address that trying to connect another computer with suspicious port.
    2.	Port Scan (without time aspects) – IP address that trying to connect another computer in more than 10 different ports.
    3.	Ping Sweep (without time aspects) – IP address that searching for different IP addresses with ping (port 0)
    4.	Ping Sweep (with time aspect) – same as ping sweep but within 10 seconds.
